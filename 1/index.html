<!DOCTYPE html>
<html>
<head>
    <title>Project 1</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        img {
            max-width: 400px; /* keep images reasonable size */
            margin: 10px;
            display: block;
        }
    </style>
</head>
<body>
    <h1>Project 1</h1>
    <h1>A: This is the naiive variant, with no finetuning and just a quick pyramid search:</h1>
    You can see that the photos are not cropped and also the color is not adjusted. Scroll down to see it with bells and whistles.


    <style>
        .gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        grid-gap: 10px;
        }
        .gallery img {
        width: 100%;
        height: auto;
        border-radius: 5px;
        object-fit: cover;
        transition: transform 0.2s;
        }
        .gallery img:hover {
        transform: scale(1.05);
        }
    </style>

    <h2>Photo Gallery (The last three are my personal picks from the archive)</h2>

    <div class="gallery">
        <img src="first/cathedral.jpg" alt="cathedral">
        <img src="first/church.jpg" alt="church">
        <img src="first/emir.jpg" alt="emir">
        <img src="first/harvesters.jpg" alt="harvesters">
        <img src="first/icon.jpg" alt="icon">
        <img src="first/italil.jpg" alt="italil">
        <img src="first/lastochikino.jpg" alt="lastochikino">
        <img src="first/lugano.jpg" alt="lugano">
        <img src="first/melons.jpg" alt="melons">
        <img src="first/monastery.jpg" alt="monastery">
        <img src="first/self_portrait.jpg" alt="self portrait">
        <img src="first/siren.jpg" alt="siren">
        <img src="first/three_generations.jpg" alt="three generations">
        <img src="first/tobolsk.jpg" alt="tobolsk">
        <img src="first/extra1.jpg" alt="extra_picture">
        <img src="first/extra2.jpg" alt="extra_picture">
        <img src="first/extra3.jpg" alt="extra_picture">
    </div>
    </body>
    </html>

It can be observed, that while the pictures almost align and the colours seem to add up to a intuitive mixture, forming well known color palets and a detectible subject, the quality is still not perfect and we can observe a lot of artefacts and color issues. The pictures are still in their original shape and the borders are clearly visible

Image: master-pnp-prok-00100-00106a Shift_G: [36. -6.] Shift_R: [ 89. -12.]
Image: master-pnp-prok-00100-00176a Shift_G: [75. 19.] Shift_R: [93. 11.]
Image: master-pnp-prok-00000-00093a Shift_G: [18. -7.] Shift_R: [ 57. -15.]

<h1>B: This is the variant using edge detection for alignment, a color channel scaling and color correction for better quality:</h1>

    The steps taken are explained in more detail below. but lets just share the results first.

    <h2>Photo Gallery</h2>

    <div class="gallery">
        <img src="second/cathedral.jpg" alt="cathedral">
        <img src="second/church.jpg" alt="church">
        <img src="second/emir.jpg" alt="emir">
        <img src="second/harvesters.jpg" alt="harvesters">
        <img src="second/icon.jpg" alt="icon">
        <img src="second/italil.jpg" alt="italil">
        <img src="second/lastochikino.jpg" alt="lastochikino">
        <img src="second/lugano.jpg" alt="lugano">
        <img src="second/melons.jpg" alt="melons">
        <img src="second/monastery.jpg" alt="monastery">
        <img src="second/self_portrait.jpg" alt="self portrait">
        <img src="second/siren.jpg" alt="siren">
        <img src="second/three_generations.jpg" alt="three generations">
        <img src="second/tobolsk.jpg" alt="tobolsk">
        <img src="second/extra1.jpg" alt="extra_picture">
        <img src="second/extra2.jpg" alt="extra_picture">
        <img src="second/extra3.jpg" alt="extra_picture">
    </div>

    This version is percievably better than the first naiive try. The first step is to normalize the values for each chanel. For this it is assumed that the lowest value in each channel should be 0 and the highest 255. A MinMax scaler is used to approptiately project our values into this space. To align the channels this time i use edge detection. For this the channals are first blurred with gaussians to get rid of noise. Edges are being detected with canny. The next step is to try to align these edges, Pyramids are used to speed this action up again. In the next step the picture is cropped by detecting the black frame around the picture and cutting off the edges accordingly. In the next step i try to estimte the illuminance of the picture to correct the lighting. For this i use only inner pixels and not the pixels from the border, since these are contaminated by a lot of monochromatic artifacts. I then take this mean lighting and correct the images entire lighting with this, since we know that idiealy these colours should be balanced. This means the ideal average pixel is gray. Lastly I need to apply a colour mask to correct for the plates Prokudin-Gorskii used not being standardized to our modern day RGB standard. So his pure red was just not the same as ours. I tried to aproximate this with a matrix to transform between the colour spaces. I just used a little trial and error for this and tried to make it look realisitically.
</body>
</html>
