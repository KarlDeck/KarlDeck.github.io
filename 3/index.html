<!DOCTYPE html>
<html lang="en">
<head>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CS180/280A — Project 3A & 3B: Image Warping, Mosaicing & Autostitching</title>
  <style>
    :root{
      --ink:#0f172a;--muted:#475569;--line:#e2e8f0;--bg:#ffffff;--chip:#f1f5f9;--panel:#f8fafc;--accent:#003262;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial;color:var(--ink);background:var(--bg)}
    header{border-bottom:1px solid var(--line);padding:16px 20px;display:flex;align-items:center;gap:16px}
    header img{height:36px;width:auto;display:block}
    header .titles{display:flex;flex-direction:column}
    header h1{margin:0;font-size:20px;line-height:1.25}
    header p{margin:2px 0 0;color:var(--muted);font-size:14px}
    main{max-width:1000px;margin:0 auto;padding:24px 20px 120px}
    h2,h3{margin:0 0 12px}
    h2{margin-top:28px;padding-top:8px;border-top:1px solid var(--line)}
    p{margin:8px 0 14px}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:12px;grid-template-columns:repeat(12,1fr)}
    .g-3{grid-column:span 3} .g-4{grid-column:span 4} .g-6{grid-column:span 6} .g-8{grid-column:span 8} .g-12{grid-column:span 12}
    @media (max-width: 860px){ .g-3,.g-4,.g-6,.g-8,.g-12{grid-column:span 12} }
    figure{margin:0;border:1px solid var(--line);border-radius:10px;overflow:hidden;background:var(--panel)}
    figure img{display:block;width:100%;height:auto}
    figcaption{padding:8px 10px;font-size:13px;color:var(--muted);background:var(--chip)}
    pre{background:#0f172a;color:#e2e8f0;padding:14px;border-radius:10px;overflow:auto;font-size:13px}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .badge{display:inline-block;padding:2px 8px;border-radius:999px;background:var(--chip);color:var(--muted);font-size:12px;margin-left:8px}
    .callout{border:1px dashed var(--line);background:var(--panel);border-radius:10px;padding:12px 14px;margin:10px 0}
    .todo{color:#b91c1c;font-weight:600}
    .toc{padding:10px 12px;border:1px solid var(--line);background:var(--panel);border-radius:10px}
    .toc a{color:var(--accent);text-decoration:none}
    .toc ul{margin:6px 0 0 16px;padding:0}
    .toc li{margin:4px 0}
    .mono{font-variant-ligatures:none}
    .divider{height:1px;background:var(--line);margin:32px 0}
    .chip{display:inline-block;padding:4px 10px;border-radius:999px;background:var(--chip);font-size:12px;color:var(--muted)}
    .backtotop{display:inline-block;margin-top:8px;font-size:13px}
    .backtotop a{color:var(--accent);text-decoration:none}
  </style>
</head>
<body>
  <header id="top">
    <!-- Replace with your local logo asset if desired -->
    <img src="assets/berkeley-logo.png" alt="UC Berkeley" />
    <div class="titles">
      <h1>Programming Project #3 — Image Warping, Mosaicing & Autostitching</h1>
      <p>CS180/280A: Intro to Computer Vision & Computational Photography <span class="badge">Part A & Part B</span></p>
    </div>
  </header>

  <main>

    <!-- ------------------- A.1 ------------------- -->
    <section id="a1">
      <h2>A.1 — Shoot the Pictures</h2>
      <div class="grid">
        <figure class="g-6"><img src="pic1left.jpg" alt="Set 1 - Image 1" /><figcaption>Set 1 — Image 1</figcaption></figure>
        <figure class="g-6"><img src="pic1right.jpg" alt="Set 1 - Image 2" /><figcaption>Set 1 — Image 2</figcaption></figure>
        <figure class="g-6"><img src="doe1.jpg" alt="Set 2 - Image 1" /><figcaption>Set 2 — Image 1</figcaption></figure>
        <figure class="g-6"><img src="doe2.jpg" alt="Set 2 - Image 2" /><figcaption>Set 2 — Image 2</figcaption></figure>
        <figure class="g-6"><img src="bridge_left.jpg" alt="Set 3 - Image 1" /><figcaption>Set 3 — Image 1</figcaption></figure>
        <figure class="g-6"><img src="bridge_right.jpg" alt="Set 3 - Image 2" /><figcaption>Set 3 — Image 2</figcaption></figure>
      </div>
    </section>

    <!-- ------------------- A.2 ------------------- -->
    <section id="a2">
      <h2>A.2 — Recover Homographies</h2>
      <p>Given n point correspondences <code>(p, p')</code>, solve <span class="mono">p' = H p</span> for the 3×3 homography <code>H</code> (8 dof, set <code>H[2,2]=1</code> or normalize post‑hoc). Use <em>more than four</em> correspondences and solve via least squares.</p>
      <div class="grid">
        <figure class="g-6"><img src="set1.png" alt="Correspondences vis" /><figcaption>Point correspondences visualization</figcaption></figure>
        <figure class="g-6"><img src="a2/equation_layout.png" alt="A h = b layout" /><figcaption>System of Equations (for each correspondence):

Point 1: (x=2527.0, y=1678.0) → (u=1725.0, v=1688.0)
  2527.0*h1 + 1678.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -4359075.0*h7 + -2894550.0*h8 =   1725.0
    0*h1 +   0*h2 + 0*h3 + 2527.0*h4 + 1678.0*h5 + 1*h6 + -4265576.0*h7 + -2832464.0*h8 =   1688.0

Point 2: (x=1824.0, y=1451.0) → (u=1062.0, v=1418.0)
  1824.0*h1 + 1451.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -1937088.0*h7 + -1540962.0*h8 =   1062.0
    0*h1 +   0*h2 + 0*h3 + 1824.0*h4 + 1451.0*h5 + 1*h6 + -2586432.0*h7 + -2057518.0*h8 =   1418.0

Point 3: (x=2261.0, y=1466.0) → (u=1487.0, v=1472.0)
  2261.0*h1 + 1466.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -3362107.0*h7 + -2179942.0*h8 =   1487.0
    0*h1 +   0*h2 + 0*h3 + 2261.0*h4 + 1466.0*h5 + 1*h6 + -3328192.0*h7 + -2157952.0*h8 =   1472.0

Point 4: (x=2218.0, y=1313.0) → (u=1443.0, v=1318.0)
  2218.0*h1 + 1313.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -3200574.0*h7 + -1894659.0*h8 =   1443.0
    0*h1 +   0*h2 + 0*h3 + 2218.0*h4 + 1313.0*h5 + 1*h6 + -2923324.0*h7 + -1730534.0*h8 =   1318.0

Point 5: (x=2860.0, y=1241.0) → (u=2009.0, v=1300.0)
  2860.0*h1 + 1241.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -5745740.0*h7 + -2493169.0*h8 =   2009.0
    0*h1 +   0*h2 + 0*h3 + 2860.0*h4 + 1241.0*h5 + 1*h6 + -3718000.0*h7 + -1613300.0*h8 =   1300.0

Point 6: (x=2801.0, y=1416.0) → (u=1963.0, v=1459.0)
  2801.0*h1 + 1416.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -5498363.0*h7 + -2779608.0*h8 =   1963.0
    0*h1 +   0*h2 + 0*h3 + 2801.0*h4 + 1416.0*h5 + 1*h6 + -4086659.0*h7 + -2065944.0*h8 =   1459.0

Point 7: (x=1744.0, y=1519.0) → (u=984.0, v=1485.0)
  1744.0*h1 + 1519.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -1716096.0*h7 + -1494696.0*h8 =    984.0
    0*h1 +   0*h2 + 0*h3 + 1744.0*h4 + 1519.0*h5 + 1*h6 + -2589840.0*h7 + -2255715.0*h8 =   1485.0

Point 8: (x=1615.0, y=1381.0) → (u=845.0, v=1334.0)
  1615.0*h1 + 1381.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -1364675.0*h7 + -1166945.0*h8 =    845.0
    0*h1 +   0*h2 + 0*h3 + 1615.0*h4 + 1381.0*h5 + 1*h6 + -2154410.0*h7 + -1842254.0*h8 =   1334.0

Point 9: (x=1128.0, y=1432.0) → (u=309.0, v=1346.0)
  1128.0*h1 + 1432.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -348552.0*h7 + -442488.0*h8 =    309.0
    0*h1 +   0*h2 + 0*h3 + 1128.0*h4 + 1432.0*h5 + 1*h6 + -1518288.0*h7 + -1927472.0*h8 =   1346.0

Point 10: (x=1321.0, y=1557.0) → (u=528.0, v=1493.0)
  1321.0*h1 + 1557.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -697488.0*h7 + -822096.0*h8 =    528.0
    0*h1 +   0*h2 + 0*h3 + 1321.0*h4 + 1557.0*h5 + 1*h6 + -1972253.0*h7 + -2324601.0*h8 =   1493.0

Recovered Homography Matrix:

1.351950  6.568187e-03 -1184.644858
0.262277  1.229552e+00  -533.999969
0.000119 -6.898342e-07     1.000000</figcaption></figure>
      </div>
      <div class="grid">
        <figure class="g-6"><img src="set2.png" alt="Correspondences vis" /><figcaption>Point correspondences visualization</figcaption></figure>
        <figure class="g-6"><img src="a2/equation_layout.png" alt="A h = b layout" /><figcaption>System of Equations (for each correspondence):

Point 1: (x=2664.0, y=2890.0) → (u=399.0, v=1716.0)
  2664.0*h1 + 2890.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -1062936.0*h7 + -1153110.0*h8 =    399.0
    0*h1 +   0*h2 + 0*h3 + 2664.0*h4 + 2890.0*h5 + 1*h6 + -4571424.0*h7 + -4959240.0*h8 =   1716.0

Point 2: (x=2706.0, y=3183.0) → (u=369.0, v=2053.0)
  2706.0*h1 + 3183.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -998514.0*h7 + -1174527.0*h8 =    369.0
    0*h1 +   0*h2 + 0*h3 + 2706.0*h4 + 3183.0*h5 + 1*h6 + -5555418.0*h7 + -6534699.0*h8 =   2053.0

Point 3: (x=2740.0, y=3186.0) → (u=410.0, v=2054.0)
  2740.0*h1 + 3186.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -1123400.0*h7 + -1306260.0*h8 =    410.0
    0*h1 +   0*h2 + 0*h3 + 2740.0*h4 + 3186.0*h5 + 1*h6 + -5627960.0*h7 + -6544044.0*h8 =   2054.0

Point 4: (x=2698.0, y=2910.0) → (u=439.0, v=1742.0)
  2698.0*h1 + 2910.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -1184422.0*h7 + -1277490.0*h8 =    439.0
    0*h1 +   0*h2 + 0*h3 + 2698.0*h4 + 2910.0*h5 + 1*h6 + -4699916.0*h7 + -5069220.0*h8 =   1742.0

Point 5: (x=2764.0, y=2939.0) → (u=509.0, v=1776.0)
  2764.0*h1 + 2939.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -1406876.0*h7 + -1495951.0*h8 =    509.0
    0*h1 +   0*h2 + 0*h3 + 2764.0*h4 + 2939.0*h5 + 1*h6 + -4908864.0*h7 + -5219664.0*h8 =   1776.0

Point 6: (x=2811.0, y=3350.0) → (u=444.0, v=2217.0)
  2811.0*h1 + 3350.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -1248084.0*h7 + -1487400.0*h8 =    444.0
    0*h1 +   0*h2 + 0*h3 + 2811.0*h4 + 3350.0*h5 + 1*h6 + -6231987.0*h7 + -7426950.0*h8 =   2217.0

Point 7: (x=2993.0, y=3217.0) → (u=675.0, v=2060.0)
  2993.0*h1 + 3217.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -2020275.0*h7 + -2171475.0*h8 =    675.0
    0*h1 +   0*h2 + 0*h3 + 2993.0*h4 + 3217.0*h5 + 1*h6 + -6165580.0*h7 + -6627020.0*h8 =   2060.0

Point 8: (x=2587.0, y=2940.0) → (u=286.0, v=1776.0)
  2587.0*h1 + 2940.0*h2 + 1*h3 +   0*h4 +   0*h5 +   0*h6 + -739882.0*h7 + -840840.0*h8 =    286.0
    0*h1 +   0*h2 + 0*h3 + 2587.0*h4 + 2940.0*h5 + 1*h6 + -4594512.0*h7 + -5221440.0*h8 =   1776.0

Recovered Homography Matrix:

-2.690520  0.450881 5121.018741
-1.391221 -2.718983 8384.448437
-0.000778 -0.000270    1.000000</figcaption></figure>
      </div>
      <div class="grid">
        <figure class="g-6"><img src="set3.png" alt="Correspondences vis" /><figcaption>Point correspondences visualization</figcaption></figure>
        <figure class="g-6"><img src="a2/equation_layout.png" alt="A h = b layout" /><figcaption>Linear system A h = b</figcaption></figure>
      </div>
      <div class="grid">
        <figure class="g-6"><img src="set4.png" alt="Correspondences vis" /><figcaption>Point correspondences visualization</figcaption></figure>
        <figure class="g-6"><img src="a2/equation_layout.png" alt="A h = b layout" /><figcaption>Linear system A h = b</figcaption></figure>
      </div>
    </section>

    <!-- ------------------- A.3 ------------------- -->
    <section id="a3">
      <h2>A.3 — Warp the Images</h2>
      <div class="grid">
        <figure class="g-6"><img src="warp1.png" alt="Warp (NN)" /><figcaption>Warp result — Nearest Neighbor</figcaption></figure>
      </div>
      <div class="grid">
        <figure class="g-6"><img src="warp2.png" alt="Warp (NN)" /><figcaption>Warp result — Nearest Neighbor</figcaption></figure>
      </div>
      <p class="muted">The bilinear ones look a little better. Linear is a little faster.</p>
    </section>

    <!-- ------------------- A.4 ------------------- -->
    <section id="a4">
      <h2>A.4 — Blend Images into a Mosaic </h2>
      <p>Register all images to a common canvas (leave one unwarped or create a new reference frame). Blend with feathering (alpha falloff) or a multi‑band method (e.g., Laplacian pyramid) to reduce seams and ghosting.</p>
      <div class="grid">
        <figure class="g-12"><img src="join1.png" alt="Sources" /><figcaption>Source stacks aligned on a common canvas</figcaption></figure>
        <figure class="g-12"><img src="join2.png" alt="Sources" /><figcaption>Source stacks aligned on a common canvas</figcaption></figure>
        <figure class="g-12"><img src="join3.png" alt="Sources" /><figcaption>Source stacks aligned on a common canvas</figcaption></figure>
        <figure class="g-12"><img src="join4.png" alt="Sources" /><figcaption>Source stacks aligned on a common canvas</figcaption></figure>
        <figure class="g-12"><img src="join5.png" alt="Sources" /><figcaption>Source stacks aligned on a common canvas</figcaption></figure>
      </div>
      <div class="callout"><strong>Deliverables:</strong> Show <em>three</em> mosaics with their source images. The originals can be seen on the top of the page</div>
    </section>

    <!-- ------------------- A.5 ------------------- -->
    <section id="a5">
      <h2>A.5 — Bells & Whistles </h2>
      <div class="grid">
        <figure class="g-6"><img src="cylinder.png" alt="Cylindrical" /><figcaption>Cylindrical panorama</figcaption></figure>
      </div>
      <model-viewer src="pano_cyl.glb"
              alt="Cylindrical panorama 3D"
              camera-controls
              auto-rotate
              exposure="1.2"
              style="width:100%; height:480px; background-color:#f9fafb;">
      </model-viewer>
      <div class="backtotop"><a href="#top">↑ Back to top</a></div>
    </section>

    <div class="divider"></div>

    <!-- ========================================================= -->
    <!-- =======================   PART B   ======================= -->
    <!-- ========================================================= -->
    <section id="b0">
      <h2>Task B — Automatic Image Mosaicing (Autostitch)</h2>
      <p class="muted">In Part B, we automate the correspondence & stitching pipeline: detect interest points (Harris), cull via ANMS, build simple descriptors, match with a ratio test, estimate a robust homography with RANSAC, and finally warp & blend for an automatic mosaic.</p>
    </section>

    <section id="b1">
      <h3>B.1 — Harris Corner Detection + ANMS</h3>
      <div class="grid">
        <figure class="g-6"><img src="b1/input.png" alt="Input image" /><figcaption>Input image</figcaption></figure>
        <figure class="g-6"><img src="b1/harriscorners.png" alt="Harris corners overlaid" /><figcaption>Harris corners overlaid (no ANMS)</figcaption></figure>
      </div>
      <div class="grid">
        <figure class="g-6"><img src="b1/harriscornersANMS.png" alt="Corners after ANMS" /><figcaption>Chosen corners overlaid (with ANMS)</figcaption></figure>
        <figure class="g-6"><img src="b1/multiscale.png" alt="Corners after ANMS" /><figcaption>Chosen corners overlaid (with ANMS)</figcaption></figure>
      </div>
    </section>

    <section id="b2">
      <h3>B.2 — Feature Descriptor Extraction (8×8 from 40×40)</h3>
      <div class="grid">
        <figure class="g-6"><img src="b2/corners.png" alt="Example 40x40 patches" /><figcaption>Corners</figcaption></figure>
        <figure class="g-6"><img src="b2/descriptors8x8.png" alt="8x8 descriptor grid" /><figcaption>Normalized 8×8 descriptors (several examples)</figcaption></figure>
        <figure class="g-6"><img src="b2/rotationinv.png" alt="8x8 descriptor grid rotation invariant" /><figcaption>Normalized 8×8 descriptors rotation invariant</figcaption></figure>
      </div>
    </section>

    <section id="b3">
      <h3>B.3 — Feature Matching (SSD + Lowe Ratio)</h3>
      <div class="grid">
        <figure class="g-12"><img src="b3/matched.png" alt="Matches for set 1" /><figcaption>Matched features — Set 1</figcaption></figure>
        <figure class="g-12"><img src="b3/match2.png" alt="Matches for set 2" /><figcaption>Matched features — Set 2</figcaption></figure>
        <figure class="g-12"><img src="b3/match3.png" alt="Matches for set 3" /><figcaption>Matched features — Set 3</figcaption></figure>
      </div>
      <div class="callout"><strong>Deliverables:</strong> Upload one figure per pair (e.g., <code>b3/matches_set#.png</code>).</div>
    </section>

    <section id="b4">
      <h3>B.4 — RANSAC for Robust Homography</h3>
    <section id="b6">
      <h3>B.6 — Results</h3>
      <p>Automatic mosaics for the same triplets from Part A see part A for comparison to handstitched</p>
      <div class="grid">
        <figure class="g-12"><img src="b6/join1.png" alt="Auto mosaic 1" /><figcaption>Autostitch result — Set 1</figcaption></figure>
        <figure class="g-12"><img src="b6/join2.png" alt="Auto mosaic 2" /><figcaption>Autostitch result — Set 2</figcaption></figure>
        <figure class="g-12"><img src="b6/join3.png" alt="Auto mosaic 3" /><figcaption>Autostitch result — Set 3</figcaption></figure>
        <figure class="g-12"><img src="b6/join3.png" alt="Auto mosaic 4" /><figcaption>Autostitch result — Set 3</figcaption></figure>
      </div>
      <div class="callout"><strong>Deliverables:</strong> Show matched features, inlier visualization, recovered <code>H</code>, and final stitched mosaics for at least two image pairs/sets.</div>
    </section>

    <section id="b7">
      <h3>B.7 — Reflection</h3>
      <p class="muted">Key takeaways: ANMS dramatically improves coverage; simple 8×8 descriptors suffice with ratio test + RANSAC; failure cases arise from strong parallax, low texture, or repeated patterns; multi‑band blending reduces residual seams.</p>
      <div class="backtotop"><a href="#top">↑ Back to top</a></div>
    </section>

    <!-- ------------------- Reflection (A) ------------------- -->
    <section id="learning">
      <h2>Most Important Thing I Learned</h2>
      <p class="muted">Stability of homography estimation with over‑determined correspondences; inverse mapping nuances; alpha design for robust blending; pros/cons of planar vs. cylindrical projection.</p>
    </section>

      <section id="submit">
      <h2>Deliverables & Submission (Part B)</h2>
      <p>Ensure the following are present on this page (Parts A+B):</p>
      <ul>
        <li><strong>B.1:</strong> <code>b1/harris_overlay.png</code>, <code>b1/anms_overlay.png</code> (plus optional <code>b1/random_overlay.png</code>)</li>
        <li><strong>B.2:</strong> <code>b2/patches40.png</code>, <code>b2/descriptors8x8.png</code></li>
        <li><strong>B.3:</strong> <code>b3/matches_set1.png</code>, <code>b3/matches_set2.png</code>, <code>b3/matches_set3.png</code></li>
        <li><strong>B.4:</strong> <code>b4/inliers_set#.png</code> and <code>b4/compare#_manual.png</code> vs <code>b4/compare#_auto.png</code> for ≥3 sets</li>
        <li><strong>B.5:</strong> Figures per chosen option + <code>b5/showcase.png</code></li>
      </ul>
      <div class="callout">
        <p><strong>Turn in:</strong> your code + this webpage. Submit your public URL to the class gallery via the course form. Your submission for Part B should include the contents of Part A and B.</p>
      </div>
      <div class="backtotop"><a href="#top">↑ Back to top</a></div>
    </section>

  </main>
</body>
</html>
